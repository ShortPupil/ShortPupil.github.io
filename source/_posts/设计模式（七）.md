---
title: 设计模式（七） 对象行为型模式 VISTOR 访问者
date: 2018-11-21 09:04:24
tags: [design pattern]
categories: 软件设计
copyright: true
---

# 目录

@[toc]



## 1. 意图

作用于某对象结构中各元素的操作。它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。



## 2. 别名



## 3. 动机

对于系统中的某些对象，它们存储在同一个集合中，且具有**不同的类型**，而且对于该集合中的对象，可以接受一类称为**访问者的对象**来访问，而且**不同的访问者其访问方式有所不同**，访问者模式为解决这类问题而诞生。

在实际使用时，对同一集合对象的操作**并不是唯一**的，对相同的元素对象可能存在**多种不同的操作方式**。而且这些操作方式**并不稳定**，可能还需要**增加新的操作**，以满足新的业务需求。

![](https://raw.githubusercontent.com/ShortPupil/ShortPupil.github.io/hexo/source/_posts/pictures/visitor_2.png)



## 4. 适用性





## 5. 结构

![](https://raw.githubusercontent.com/ShortPupil/ShortPupil.github.io/hexo/source/_posts/pictures/visitor_1.png)



## 6. 参与者

## 7. 协作

## 8. 效果

## 9. 实现

## 10. 代码示例

```c++
class Teacher : Employee{
	public Teacher(string name, double income,int vacationDays){
		Name = name;
		Income = income;
		VacationDays = vacationDays;
	}
	public override void Accept(Visitor visitor){
		visitor.Visit(this);
	}
}

class Engineer : Employee{
	public Engineer(string name, double income,int vacationDays){
		Name = name;
		Income = income;
		VacationDays = vacationDays;
	}
	public override void Accept(Visitor visitor){
		visitor.Visit(this);
	}
}

abstract class Visitor{
	abstract public void Visit(Employee element);
}
class IncomeVisitor : Visitor
{
	public override void Visit(Employee element){
		element.Income *= 1.10;
		Console.WriteLine(element.Name + "的新工资是: " + element.Income);
	}
}

class VacationVisitor : Visitor{
	public override void Visit(Employee element){
		element.VacationDays += 3;
		Console.WriteLine(element.Name + "的新假期是" + element.VacationDays);
	}
}

class Employees{
	private ArrayList employees = new ArrayList();
	public void Attach(Employee employee){
		employees.Add(employee);
	}
	public void Detach(Employee employee){
		employees.Remove(employee);
	}
	public void Accept(Visitor visitor){
		foreach (Employee e in employees)
		e.Accept(visitor);
	}
}

//使用
static void Main(string[] args){
	Teacher zhangsan = new Teacher("张三", 2500.0, 14);
	Engineer lisi = new Engineer("李四", 3500.0, 16);
	Employees e = new Employees();
	e.Attach(zhangsan);
	e.Attach(lisi);
	IncomeVisitor v1 = new IncomeVisitor();
	VacationVisitor v2 = new VacationVisitor();
	e.Accept(v1);
	e.Accept(v2);
	Console.Read();
}
```





## 11. 已知应用



## 拓展

对大量子类进行批量操作？


